description: >
  Populates environment variables useful for signing the newly tagged images.
parameters:
  image:
    type: string
    description: "Container image to use as a prefix to the URI and Digest."
  image_uri_env_var:
    type: env_var_name
    default: "IMAGE_URI"
    description: "Environment variable to populate the image URI with."
  image_digest_env_var:
    type: env_var_name
    default: "IMAGE_DIGEST"
    description: "Environment variable to populate the image digest with."
  tag_env_var:
    type: env_var_name
    default: "TAG"
    description: "Environment variable to populate the most specific tag with."
steps:
  - run:
      environment:
        PARAM_IMAGE: << parameters.image >>
        PARAM_IMAGE_DIGEST_ENV_VAR: << parameters.image_digest_env_var >>
        PARAM_IMAGE_URI_ENV_VAR: << parameters.image_uri_env_var >>
        PARAM_TAG_ENV_VAR: << parameters.tag_env_var >>
      name: Populate Environment Variables
      command: <<include(scripts/populate_env_vars.sh)>>
